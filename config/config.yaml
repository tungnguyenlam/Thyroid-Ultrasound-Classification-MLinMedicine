
#==============================================================================
#  config.yaml  —  Thyroid Ultrasound Classification
#  DO NOT EDIT THIS FILE
#==============================================================================

#  Data
data:
  data_dir: "data/"          # root of the downloaded dataset (ImageFolder layout)
  img_size: 512              # resize to (img_size × img_size)
  num_classes: 2             # benign / malignant
  seed: 42                   # fixed seed -> fixed train/val/test split every run
  train_ratio: 0.70
  val_ratio:   0.15
  # test_ratio is inferred: 1 - train_ratio - val_ratio = 0.15

#  Model
model:
  name: "res18"              # folder name inside models/  (res18 | res50 | densenet | efficientnet | ...)

#  Training
training:
  epochs: 30
  batch_size: 32
  lr: 0.0001
  weight_decay: 0.0001
  optimizer: "adam"          # adam | sgd | adamw
  scheduler: "cosine"        # cosine | step | none
  step_size: 10              # (only if scheduler == step) decay every N epochs
  gamma: 0.1                 # (only if scheduler == step) LR multiplier
  early_stopping_patience: 7 # stop if val_loss doesn't improve for N epochs
  # ------ Loss function --------------------------------------------------------
  loss: "focal"              # cross_entropy | weighted_cross_entropy | label_smoothing | focal | focal_ce
  loss_gamma: 2.0            # focal: focusing exponent γ  (ignored by CE / LS)
  loss_alpha: 0.25           # focal: scalar weighting α   (ignored by CE / LS)
  loss_smoothing: 0.1        # label_smoothing / focal_ce: ε  (ignored by focal / CE)
  loss_blend: 0.5            # focal_ce: weight given to focal term (0 = pure CE, 1 = pure focal)
  class_weights: null        # weighted_cross_entropy: list of floats [w0, w1, …] or null

#  Results
results:
  base_dir: "results/"       # outputs go to results/<model.name>/
